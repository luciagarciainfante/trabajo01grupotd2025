---
title: "Trabajo 1. Teoría de la Decisión. Enunciados y soluciones"
author: "Grupo 3. Lucía García Infante, Rosa Fernandez López, Sergio Pacheco Márquez, Victor Silva Nieves"
format:
  html: default
  pdf: default
---


```{r}
source("teoriadecision_funciones_incertidumbre.R")
```


# EJERCICIO 1. Lucía García Infante.
Aplicar los criterios de decisión bajo incertidumbre al siguiente problema considerando una situación favorable (beneficios) y desfavorable (costos)

|    | e1  | e2  | e3  | e4  | e5  | e6  |
|----|-----|-----|-----|-----|-----|-----|
| d1 | 100 | 200 | 130 | 150 | 240 | 100 |
| d2 | 300 | 145 | 230 | 345 | 200 | 280 |
| d3 | 120 | 300 | 260 | 400 | 100 | 330 |
| d4 | 180 | 130 | 300 | 370 | 280 | 190 |
| d5 | 200 | 140 | 135 | 280 | 190 | 100 |



## Apartado a. Tabla correspondiente a beneficios. 

```{r}
tb01a = crea.tablaX(c(100,200,130,150,240,100,
                      300,145,230,345,200,280,
                      120,300,260,400,100,330,
                      180,130,300,370,280,190,
                      200,140,135,280,190,100),
                    numalternativas = 5, numestados = 6)
```
\pagebreak

**1. Método de Wald**

Para cada alternativa se supone que va a pasar lo peor, y elige aquella alternativa que dé mejor valor.

```{r}
b1 = criterio.Wald(tb01a,favorable=TRUE)
names(b1$AlternativaOptima)
```


**2. Método Optimista**

Para cada alternativa se supone que pasará lo mejor, y se elige laa que dé mejor valor. 
```{r}
b2 = criterio.Optimista(tb01a,favorable = TRUE)
names(b2$AlternativaOptima)
```

**3. Método Hurwicz**

Combina optimismo y pesimismo usando un coeficiente de optimismo $\alpha$:

$$
\text{Valor Hurwicz} = \alpha \cdot \max + (1-\alpha) \cdot \min
$$
Resolvemos considerando $\alpha$ = 0.5.
```{r}
b3 = criterio.Hurwicz(tb01a,alfa=0.5,favorable=TRUE)
names(b3$AlternativaOptima)
```

Ahora vamos a hacer un análisis de la decisiones en función del $\alpha$. Para ello disponemos de dos funciones, una que te hace la gráfica, y otra que además te da los intervalos. Usamos la completa: 
```{r}
dibuja.criterio.Hurwicz_Intervalos(tb01a,T)
```

:::{.callout-tip}
### Interpretación: 
Para valores de $\alpha$ entre 0 y 0.375, se elegirá la alternativa 2. 
Para valores entre 0.375 y 0.5 se elegirá la alternativa 4. 
Para valores entre 0.5 1, elegiremos la 3.

Vemos que efectivamente tenemos el mismo resultado que el obtenido al principio. 
Justo el $\alpha$ = 0.5 es el punto de corte entre las rectas. Por eso nos salen dos alternativas.
:::


**4. Método Savage**

Minimiza el arrepentimiento máximo comparando lo que se pudo ganar y lo que se ganó.

```{r}
b4 = criterio.Savage(tb01a,favorable=TRUE)
names(b4$AlternativaOptima)
```


**5. Método Laplace**

Asume que todos los estados son igualmente probables y elige la alternativa con mayor promedio.

```{r}
b5 = criterio.Laplace(tb01a,favorable=TRUE)
names(b5$AlternativaOptima)
```


**6. Método Punto Ideal**
Considera un resultado perfecto y mide la distancia de cada alternativa a ese ideal, eligiendo la más cercana.
```{r}
b6 = criterio.PuntoIdeal(tb01a,favorable=TRUE)
names(b6$AlternativaOptima)
```


:::{.callout-tip}
### Conclusiones: 
Tomando los datos de la tabla como beneficios, los resultados que obtenemos son: La decisión 1 y la 5 no se eligen en ningún método. La 2 y la 3 empatan siendo elegidas por 3 métodos. Y la decisión 4 sólo aparece en 1. 
Por tanto, las mejores decisiones en este caso son la 2 y la 3.
:::

\pagebreak

## Apartado b. Tabla correspondiente a costes. 

**1. Método de Wald**

Para cada alternativa se supone que va a pasar lo peor, y elige aquella alternativa que dé mejor valor.

```{r}
c1 = criterio.Wald(tb01a,favorable=FALSE)
names(c1$AlternativaOptima)
```

**2. Método Optimista**

Para cada alternativa se supone que pasará lo mejor, y se elige laa que dé mejor valor. 

```{r}
c2 = criterio.Optimista(tb01a,favorable = FALSE)
names(c2$AlternativaOptima)
```

**3. Método Hurwicz**

Combina optimismo y pesimismo usando un coeficiente de optimismo $\alpha$:

$$
\text{Valor Hurwicz} = \alpha \cdot \max + (1-\alpha) \cdot \min
$$

```{r}
c3 = criterio.Hurwicz(tb01a,alfa=0.5,favorable=FALSE)
names(c3$AlternativaOptima)
```

```{r}
dibuja.criterio.Hurwicz(tb01a, FALSE)
```


:::{.callout-tip}
### Interpretación: 
En este caso, por estar en el caso de costes, debemos mirar la línea más baja. Vemos que para cualquier nivel de alpha, la decisión elegida es la d1. 
Vemos que efectivamente tenemos el mismo resultado que el obtenido al principio. 
:::


**4. Método Savage**

Minimiza el arrepentimiento máximo, que se calcula a partir del coste extra que se podría haber evitado.

```{r}
c4 = criterio.Savage(tb01a,favorable=FALSE)
names(c4$AlternativaOptima)
```

**5. Método Laplace**

Calcula el promedio de costes suponiendo igual probabilidad para cada estado.

```{r}
c5 = criterio.Laplace(tb01a,favorable=FALSE)
names(c5$AlternativaOptima)
```


**6. Método Punto Ideal**

Compara la distancia a un coste ideal mínimo, eligiendo el más cercano al ideal (menor coste).
```{r}
c6 = criterio.PuntoIdeal(tb01a,favorable=FALSE)
names(c6$AlternativaOptima)
```


:::{.callout-tip}
### Conclusiones: 
Tomando los datos de la tabla como costes, los resultados que obtenemos son: La decisión 2 y la 4 no se eligen en ningún método. La 3 es elegida una única vez y la 5, dos veces. La decisión 1 es la que más veces es elegida por 5 métodos. 

Por tanto, la mejor decisión en este caso es la 1.
:::


\pagebreak



# EJERCICIO 2. Lucía García Infante.

Marina es una alumna del grado en Estadística que acaba este año. El próximo año quiere realizar un máster para mejorar sus oportunidades laborales, pero solo puede escoger uno.
Todavía no sabe en qué sitio empezará a trabajar aunque considera tres posibilidades:

- Una **empresa privada en el extranjero**.
- Una **institución pública**.
- Una **empresa privada española**.

Para decidir, Marina ha mirado tres másteres que le interesan y ha estimado cuál podría ser su primer sueldo anual según el tipo de empresa, junto con el coste de cada máster:

- **Máster en Análisis de Datos**. Espera ganar unos 26.000 € en una empresa extranjera, 18.000 € en una institución pública y 20.000 € en una empresa española. Este máster tiene un coste de 10.000 €.
- **Máster en Programación y Modelos Estadístico**. Estima que su sueldo inicial sería de 20.000 € en una empresa extranjera, 12.000 € en una institución pública y 20.000 € en una empresa privada española. El coste de este máster asciende a 6.500 €.
- **Máster en Comunicación y Gestión de Proyectos**. Espera un sueldo de 10.000 € en una empresa extranjera, 12.000 € en una institución pública y 20.000 € en una empresa privada española. Este máster tiene un coste de 3.000 €.


**Solución:**

PLANTEAMIENTO:

- Un decisor: Marina.
- Modelo de beneficios (favorable).
- Alternativas:
  - A1 = Máster en Análisis de Datos
  - A2 = Máster en Programación y Modelos Estadísticos
  - A3 = Máster en Comunicación y Gestión de Proyectos
- Estados de la naturaleza:
  - E1 = Empresa extranjera
  - E2 = Institución pública
  - E3 = Empresa privada española
- Matriz de decisión:  Beneficios = Sueldo esperado - Coste máster

```{r}
# Máster en Análisis de Datos
m11 = 26000 - 10000   # Empresa extranjera
m12 = 18000 - 10000   # Institución pública
m13 = 20000 - 10000   # Empresa española

# Máster en Programación y Modelos Estadísticos
m21 = 20000 - 6500  # Empresa extranjera
m22 = 12000 - 6500  # Institución pública
m23 = 20000 - 6500  # Empresa españolaA

# Máster en Comunicación y Gestión de Proyectos
m31 = 10000 - 3000  # Empresa extranjera
m32 = 12000 - 3000  # Institución pública
m33 = 20000 - 3000  # Empresa española

```

Inserto los datos en la tabla: 
```{r}
tb02 = crea.tablaX(c(m11,m12,m13,
                     m21,m22,m23,
                     m31,m32,m33),
    numalternativas = 3, numestados = 3,
    nb_alternativas = c("A1","A2","A3"),
    nb_estados = c("E1","E2","E3"))

tb02
```

\pagebreak

Aplico la función que devuelve todos los métodos en una única tabla: 

```{r}
sol02 = criterio.Todos(tb02, alfa=0.5, favorable=TRUE)
sol02
```

:::{.callout-tip}
### Conclusiones: 
La alternativa A1 es la opción más recomendada, ya que resulta óptima en la mayoría de los criterios (3 veces).

Por tanto, Marina debería estudiar el próximo año el Máster en Análisis de Datos.

:::


\pagebreak


# EJERCICIO 1. Rosa Fernández López.
Aplicar los criterios de decisión bajo incertidumbre (tanto en situación favorable
como desfavorable) a los problemas cuya matriz de valores numéricos viene dada en la tabla siguiente:

|  | e1 | e2 | e3 |
|:------|:----:|:----:|:----:|
| **d1**| 12 | 8  | 5  |
| **d2**| 10 | 11 | 4  |
| **d3**| 7  | 13 | 6  |

**Solución:**

```{r}
source("teoriadecision_funciones_incertidumbre.R")
```

Matriz de datos
```{r}
m1 <- crea.tablaX(c(12, 8, 5,
               10, 11, 4,
               7, 13, 6),
             numalternativas = 3, numestados = 3)
rownames(m1) <- c("d1", "d2", "d3")
colnames(m1) <- c("e1", "e2", "e3")
m1
```


Aplicar criterios en situaciones favorables
```{r}
# Criterio de Wald (pesimista)
sol_W <- criterio.Wald(m1, favorable = TRUE)
cat("La decisión óptima en el Criterio de Wald (pesimista) es: ",
    sol_W$AlternativaOptima)

# Criterio Optimista (Maximax)
sol_O <- criterio.Optimista(m1, favorable = TRUE)
cat("La decisión óptima en el Criterio Optimista (Maximax) es: ",
    sol_O$AlternativaOptima)

# Criterio de Hurwicz
sol_H <- criterio.Hurwicz(m1, favorable = TRUE, alfa = 0.5)
cat("La decisión óptima en el Criterio de Hurwicz es: ",
    sol_H$AlternativaOptima)

# Criterio de Savage (Minimax)
sol_S <- criterio.Savage(m1, favorable = TRUE)
cat("La decisión óptima en el Criterio de Savage (Minimax) es: ",
    sol_S$AlternativaOptima)

# Criterio de Laplace
sol_L <- criterio.Laplace(m1, favorable = TRUE)
cat("La decisión óptima en el Criterio de Laplace es: ",
    sol_L$AlternativaOptima)

# Criterio de Punto Ideal
sol_PI <- criterio.PuntoIdeal(m1, favorable = TRUE)
cat("La decisión óptima en el Criterio de Punto Ideal es: ",
    sol_PI$AlternativaOptima)

# Todos los criterios juntos
sol_T <- criterio.Todos(m1, favorable = TRUE, alfa = 0.5)
library(tinytable)
tt(sol_T, rownames = TRUE)

```


Resultados en situación favorable
```{r}
dibuja.criterio.Hurwicz(m1, favorable = TRUE)
```

```{r}
# Extraer la fila "iAlt.Opt" de la tabla
optimas <- sol_T["iAlt.Opt", ]

# Contar cuántas veces aparece cada alternativa
conteo <- table(as.character(optimas))

# Identificar la más frecuente
mayoria <- names(which.max(conteo))

# Mostrar el resultado
cat("Según la mayoría de criterios en situación favorable, la alternativa óptima es:", mayoria, "\n")


```

Aplicar criterios en situación desfavorable
```{r}
# Criterio de Wald (pesimista)
sol_W_d <- criterio.Wald(m1, favorable = FALSE)
cat("La decisión óptima en el Criterio de Wald (pesimista) es: ",
    sol_W_d$AlternativaOptima)

# Criterio Optimista
sol_O_d <- criterio.Optimista(m1, favorable = FALSE)
cat("La decisión óptima en el Criterio Optimista es: ",
    sol_O_d$AlternativaOptima)

# Criterio de Hurwicz
sol_H_d <- criterio.Hurwicz(m1, favorable = FALSE, alfa = 0.5)
cat("La decisión óptima en el Criterio de Hurwicz es: ",
    sol_H_d$AlternativaOptima)

# Criterio de Savage
sol_S_d <- criterio.Savage(m1, favorable = FALSE)
cat("La decisión óptima en el Criterio de Savage es: ",
    sol_S_d$AlternativaOptima)

# Criterio de Laplace
sol_L_d <- criterio.Laplace(m1, favorable = FALSE)
cat("La decisión óptima en el Criterio de Laplace es: ",
    sol_L_d$AlternativaOptima)

# Criterio de Punto Ideal
sol_PI_d <- criterio.PuntoIdeal(m1, favorable = FALSE)
cat("La decisión óptima en el Criterio de Punto Ideal es: ",
    sol_PI_d$AlternativaOptima)

# Todos los criterios juntos
sol_T_d <- criterio.Todos(m1, favorable = FALSE, alfa = 0.5)
library(tinytable)
tt(sol_T_d, rownames = TRUE)

```


Resultados en situación desfavorable
```{r}
dibuja.criterio.Hurwicz(m1, favorable = FALSE)
```
```{r}

# Extraer la fila "iAlt.Opt (Desfav.)" de la tabla
optimasdesf <- sol_T_d["iAlt.Opt (Desfav.)", ]

# Contar cuántas veces aparece cada alternativa
conteodesf <- table(as.character(optimasdesf))

# Identificar la más frecuente
mayoriadesf <- names(which.max(conteodesf))

# Mostrar el resultado
cat("Según la mayoría de criterios en situación desfavorable, la alternativa óptima es:", mayoriadesf, "\n")


```



\pagebreak


# EJERCICIO 2. Rosa Fernandez López.

**Elección de tarifa eléctrica para un nuevo piso**

Carlos se ha mudado recientemente a un nuevo piso y necesita contratar una tarifa de electricidad. Tras comparar varias compañías, ha identificado tres opciones con condiciones distintas:

- ElectroPlus ofrece una tarifa fija de 45€ al mes, independientemente del consumo eléctrico.

- LuzFlex aplica una tarifa variable de 0,20€/kWh, con una cuota base mensual de 15€.

- EcoVolt propone una tarifa variable de 0,15€/kWh sin cuota fija, pero incluye una penalización de 10€ si el consumo mensual supera los 300kWh.

Carlos no tiene certeza sobre su consumo mensual, pero considera dos escenarios posibles durante el primer año:

- Consumo moderado: 250kWh al mes.

- Consumo elevado: 350kWh al mes.

Determinar cuál sería la mejor opción para Carlos según cada criterio.

```{r}
source("teoriadecision_funciones_incertidumbre.R")
```

Cálculo de costes anuales por alternativa y escenario

```{r}
# ElectroPlus: tarifa fija
electroplus_moderado <- 45 * 12
electroplus_elevado  <- 45 * 12

# LuzFlex: tarifa variable + cuota fija
luzflex_moderado <- (250 * 0.20 + 15) * 12
luzflex_elevado  <- (350 * 0.20 + 15) * 12

# EcoVolt: tarifa variable + penalización si > 300kWh
ecovolt_moderado <- 250 * 0.15 * 12
ecovolt_elevado  <- (350 * 0.15 + 10) * 12
```

Crear la matriz de costes

```{r}
m_carlos <- crea.tablaX(c(electroplus_moderado, electroplus_elevado,
                          luzflex_moderado, luzflex_elevado,
                          ecovolt_moderado, ecovolt_elevado),
                        numalternativas = 3,
                        numestados = 2)

rownames(m_carlos) <- c("ElectroPlus", "LuzFlex", "EcoVolt")
colnames(m_carlos) <- c("Consumo moderado", "Consumo elevado")
m_carlos

```

Aplicar criterios en situación desfavorable (costes)

```{r}

sol_carlos <- criterio.Todos(m_carlos, favorable = FALSE, alfa = 0.5)

# Mostrar tabla de resultados
library(tinytable)
tt(sol_carlos, rownames = TRUE)

```

Resultados en situación desfavorable

```{r}
# Extraer la fila de alternativas óptimas
optimas <- sol_carlos["iAlt.Opt", ]
mayoria <- names(which.max(table(as.character(optimas))))

cat("Según la mayoría de criterios, la mejor tarifa para Carlos sería:", mayoria, "\n")
```

```{r}
dibuja.criterio.Hurwicz(m_carlos, favorable = FALSE)

```

Observando el gráfico, vemos que:

 - ElectroPlus (línea roja) mantiene un coste constante para cualquier valor de alpha.

 - LuzFlex (línea verde) tiene un coste intermedio, que disminuye ligeramente al aumentar alpha.

 - EcoVolt (línea azul) es la más sensible al valor de alpha: si alpha es bajo (más pesimista), su coste es alto; si alpha es alto (más optimista), su coste baja considerablemente.

 Esto indica que EcoVolt solo sería recomendable si Carlos adopta una actitud muy optimista respecto al consumo.
